echo "# This file is autogenerated using gen_mathfunctions.sh"

if [ `uname` == "Linux" ]; then
    echo "libm = dlopen("libm.so.6")"
fi

if [ `uname` == "Darwin" ]; then
    echo "libm = dlopen(\"libm.dylib\")"
fi

echo

for func in sin cos tan sinh cosh tanh asin acos atan log log10 log1p exp expm1 erf abs finite floor ceil sqrt cbrt rint gamma lgamma isnan; do
    echo "# $func"
    echo "$func(x::Float64) = ccall(dlsym(libm,\"$func\"), Float64, (Float64,), x)"
    echo "$func(x::Float32) = ccall(dlsym(libm,\"${func}f\"), Float32, (Float32,), x)"
    echo "$func(x::Vector) = [ $func(x[i]) | i=1:length(x) ]"
    echo "$func(x::Matrix) = [ $func(x[i,j]) | i=1:size(x,1), j=1:size(x,2) ]"
    echo
done

for func in atan2 pow remainder copysign hypot; do
    echo "# $func"
    echo "$func(x::Float64, y::Float64) = ccall(dlsym(libm,\"$func\"), Float64, (Float64, Float64,), x, y)"
    echo "$func(x::Float32, y::Float32) = ccall(dlsym(libm,\"${func}f\"), Float32, (Float32, Float32), x, y)"
    echo
done

